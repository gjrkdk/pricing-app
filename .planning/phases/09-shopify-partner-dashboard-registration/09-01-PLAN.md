---
phase: 09-shopify-partner-dashboard-registration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - shopify.app.production.toml
autonomous: false
user_setup:
  - service: shopify-partner-dashboard
    why: "Distribution method selection is a one-time irreversible choice that must be made in the Partner Dashboard UI"
    dashboard_config:
      - task: "Select Public distribution method"
        location: "Partner Dashboard → Apps → QuoteFlow → Distribution → Choose 'Public'"

must_haves:
  truths:
    - "Distribution method is set to Public in Partner Dashboard"
    - "App version deployed to Partner Dashboard with correct scopes, URLs, and webhooks"
    - "Partner Dashboard shows application_url as https://quote-flow-one.vercel.app"
    - "Partner Dashboard shows redirect_urls including https://quote-flow-one.vercel.app/auth/callback"
  artifacts:
    - path: "shopify.app.production.toml"
      provides: "Production app configuration matching Partner Dashboard"
      contains: "client_id"
  key_links:
    - from: "shopify.app.production.toml"
      to: "Shopify Partner Dashboard"
      via: "shopify app deploy"
      pattern: "application_url.*quote-flow-one.vercel.app"
---

<objective>
Select Public distribution for QuoteFlow in Partner Dashboard and deploy the production TOML configuration to create the first app version.

Purpose: The app needs distribution selected (irreversible choice) before it can be installed on stores. Deploying the TOML ensures Partner Dashboard config matches the production TOML exactly (scopes, URLs, webhooks). This is the prerequisite for APP-01 (correct OAuth redirects and scopes) and APP-02 (installable via direct link).

Output: QuoteFlow app with Public distribution selected and app version deployed to Partner Dashboard.
</objective>

<execution_context>
@/Users/robinkonijnendijk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/robinkonijnendijk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@shopify.app.production.toml
@.planning/phases/08-production-deploy-to-vercel/08-02-SUMMARY.md
@.planning/phases/09-shopify-partner-dashboard-registration/09-RESEARCH.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 1: Select Public distribution method in Partner Dashboard</name>
  <action>
    The user must select "Public" distribution for the QuoteFlow app in the Shopify Partner Dashboard. This choice is PERMANENT and cannot be changed.

    Distribution method determines how merchants install the app:
    - **Public** = App Store listing + Billing API support + install on any store (CHOOSE THIS)
    - Custom = Direct link only, single store, no Billing API
    - Shopify Admin = Single store, no extensions

    Public is required because the roadmap targets App Store submission and the app uses the Billing API (billing config in shopify.server.ts).
  </action>
  <instructions>
    1. Open Shopify Partner Dashboard: https://partners.shopify.com
    2. Navigate to: Apps → QuoteFlow → Distribution
    3. Click "Choose distribution"
    4. Select **Public**
    5. Confirm the selection

    WARNING: This choice is IRREVERSIBLE. Public is the correct choice for this project (App Store + Billing API).
  </instructions>
  <resume-signal>Type "done" after selecting Public distribution, or describe any issues encountered</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Deploy production TOML configuration to Partner Dashboard</name>
  <files>shopify.app.production.toml</files>
  <action>
    Run `shopify app deploy` with the production TOML to sync configuration to Partner Dashboard and create the first app version.

    Steps:
    1. Verify `shopify.app.production.toml` has correct values:
       - `client_id = "d78dd3e635d5cb58866d9d38de855675"`
       - `application_url = "https://quote-flow-one.vercel.app"`
       - `redirect_urls = ["https://quote-flow-one.vercel.app/auth/callback"]`
       - `scopes = "write_draft_orders,read_products,write_products"`
       - `use_legacy_install_flow = false`
       - `embedded = true`

    2. Run the deploy command:
       ```bash
       cd /Users/robinkonijnendijk/Desktop/pricing-app && npx shopify app deploy --config shopify.app.production.toml
       ```
       - If prompted about releasing the new version, confirm yes
       - The `--allow-updates` flag can be added if needed to skip confirmation prompts

    3. Verify the deploy output shows:
       - App version created
       - Correct scopes applied
       - Correct application_url
       - Correct redirect_urls

    If deploy fails because distribution is not yet selected (Task 1 not done), this is a blocking dependency — Task 1 must complete first.

    If deploy reports any issues with the TOML (missing fields, invalid values), fix the TOML and redeploy.
  </action>
  <verify>
    - `shopify app deploy` command completes successfully
    - Output shows app version created with correct configuration
    - No error messages about missing distribution or invalid config
  </verify>
  <done>
    App version deployed to Partner Dashboard. Configuration in Partner Dashboard matches shopify.app.production.toml (scopes, URLs, webhooks, embedded flag).
  </done>
</task>

</tasks>

<verification>
1. Partner Dashboard → Apps → QuoteFlow → Distribution shows "Public"
2. Partner Dashboard → Apps → QuoteFlow → Versions shows at least one deployed version
3. Partner Dashboard → Apps → QuoteFlow → Configuration shows:
   - App URL: https://quote-flow-one.vercel.app
   - Redirect URLs: https://quote-flow-one.vercel.app/auth/callback
   - Scopes: write_draft_orders, read_products, write_products
4. `shopify app deploy` completed without errors
</verification>

<success_criteria>
- Public distribution is selected (irreversible, confirmed by user)
- `shopify app deploy --config shopify.app.production.toml` completed successfully
- Partner Dashboard shows correct application_url, redirect_urls, and scopes
- App version exists in Partner Dashboard
</success_criteria>

<output>
After completion, create `.planning/phases/09-shopify-partner-dashboard-registration/09-01-SUMMARY.md`
</output>
